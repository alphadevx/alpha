/* ================================================
 * Make use of Twitter Bootstrap's modal more monkey-friendly.
 * 
 * For Bootstrap 3.
 * 
 * javanoob@hotmail.com
 * 
 * Licensed under The MIT License.
 * ================================================ */
var BootstrapDialog=null;!function(a){BootstrapDialog=function(b){this.defaultOptions={id:BootstrapDialog.newGuid(),type:BootstrapDialog.TYPE_PRIMARY,size:BootstrapDialog.SIZE_NORMAL,title:null,message:null,buttons:[],closable:true,spinicon:BootstrapDialog.ICON_SPINNER,data:{},onshow:null,onhide:null,autodestroy:true};this.indexedButtons={};this.realized=false;this.opened=false;this.initOptions(b);this.holdThisInstance()};BootstrapDialog.NAMESPACE="bootstrap-dialog";BootstrapDialog.TYPE_DEFAULT="type-default";BootstrapDialog.TYPE_INFO="type-info";BootstrapDialog.TYPE_PRIMARY="type-primary";BootstrapDialog.TYPE_SUCCESS="type-success";BootstrapDialog.TYPE_WARNING="type-warning";BootstrapDialog.TYPE_DANGER="type-danger";BootstrapDialog.DEFAULT_TEXTS={};BootstrapDialog.DEFAULT_TEXTS[BootstrapDialog.TYPE_DEFAULT]="Information";BootstrapDialog.DEFAULT_TEXTS[BootstrapDialog.TYPE_INFO]="Information";BootstrapDialog.DEFAULT_TEXTS[BootstrapDialog.TYPE_PRIMARY]="Information";BootstrapDialog.DEFAULT_TEXTS[BootstrapDialog.TYPE_SUCCESS]="Success";BootstrapDialog.DEFAULT_TEXTS[BootstrapDialog.TYPE_WARNING]="Warning";BootstrapDialog.DEFAULT_TEXTS[BootstrapDialog.TYPE_DANGER]="Danger";BootstrapDialog.SIZE_NORMAL="size-normal";BootstrapDialog.SIZE_LARGE="size-large";BootstrapDialog.BUTTON_SIZES={};BootstrapDialog.BUTTON_SIZES[BootstrapDialog.SIZE_NORMAL]="";BootstrapDialog.BUTTON_SIZES[BootstrapDialog.SIZE_LARGE]="btn-lg";BootstrapDialog.ICON_SPINNER="glyphicon glyphicon-asterisk";BootstrapDialog.dialogs={};BootstrapDialog.openAll=function(){a.each(BootstrapDialog.dialogs,function(c,b){b.open()})};BootstrapDialog.closeAll=function(){a.each(BootstrapDialog.dialogs,function(c,b){b.close()})};BootstrapDialog.prototype={constructor:BootstrapDialog,initOptions:function(b){this.options=a.extend(true,this.defaultOptions,b);return this},holdThisInstance:function(){BootstrapDialog.dialogs[this.getId()]=this;return this},initModalStuff:function(){this.setModal(this.createModal()).setModalDialog(this.createModalDialog()).setModalContent(this.createModalContent()).setModalHeader(this.createModalHeader()).setModalBody(this.createModalBody()).setModalFooter(this.createModalFooter());this.getModal().append(this.getModalDialog());this.getModalDialog().append(this.getModalContent());this.getModalContent().append(this.getModalHeader()).append(this.getModalBody()).append(this.getModalFooter());return this},createModal:function(){return a('<div class="modal fade" tabindex="-1" id="'+this.getId()+'"></div>')},getModal:function(){return this.$modal},setModal:function(b){this.$modal=b;return this},createModalDialog:function(){return a('<div class="modal-dialog"></div>')},getModalDialog:function(){return this.$modalDialog},setModalDialog:function(b){this.$modalDialog=b;return this},createModalContent:function(){return a('<div class="modal-content"></div>')},getModalContent:function(){return this.$modalContent},setModalContent:function(b){this.$modalContent=b;return this},createModalHeader:function(){return a('<div class="modal-header"></div>')},getModalHeader:function(){return this.$modalHeader},setModalHeader:function(b){this.$modalHeader=b;return this},createModalBody:function(){return a('<div class="modal-body"></div>')},getModalBody:function(){return this.$modalBody},setModalBody:function(b){this.$modalBody=b;return this},createModalFooter:function(){return a('<div class="modal-footer"></div>')},getModalFooter:function(){return this.$modaFooter},setModalFooter:function(b){this.$modaFooter=b;return this},createDynamicContent:function(c){var b=null;if(typeof c==="function"){b=c.call(c,this)}else{b=c}if(typeof b==="string"){b=this.formatStringContent(b)}return b},formatStringContent:function(b){return b.replace(/\r\n/g,"<br />").replace(/[\r\n]/g,"<br />")},setData:function(b,c){this.options.data[b]=c;return this},getData:function(b){return this.options.data[b]},setId:function(b){this.options.id=b;return this},getId:function(){return this.options.id},getType:function(){return this.options.type},setType:function(b){this.options.type=b;return this},getSize:function(){return this.options.size},setSize:function(b){this.options.size=b;return this},getTitle:function(){return this.options.title},setTitle:function(b){this.options.title=b;return this},getMessage:function(){return this.options.message},setMessage:function(b){this.options.message=b;return this},isClosable:function(){return this.options.closable},setClosable:function(b){this.options.closable=b;this.updateClosable();return this},getSpinicon:function(){return this.options.spinicon},setSpinicon:function(b){this.options.spinicon=b;return this},addButton:function(b){this.options.buttons.push(b);return this},addButtons:function(c){var b=this;a.each(c,function(d,e){b.addButton(e)});return this},getButtons:function(){return this.options.buttons},setButtons:function(b){this.options.buttons=b;return this},getButton:function(b){if(typeof this.indexedButtons[b]!=="undefined"){return this.indexedButtons[b]}return null},getButtonSize:function(){if(typeof BootstrapDialog.BUTTON_SIZES[this.getSize()]!=="undefined"){return BootstrapDialog.BUTTON_SIZES[this.getSize()]}return""},isAutodestroy:function(){return this.options.autodestroy},setAutodestroy:function(b){this.options.autodestroy=b},getDefaultText:function(){return BootstrapDialog.DEFAULT_TEXTS[this.getType()]},getNamespace:function(b){return BootstrapDialog.NAMESPACE+"-"+b},createHeaderContent:function(){var b=a("<div></div>");b.addClass(this.getNamespace("header"));b.append(this.createTitleContent());b.append(this.createCloseButton());return b},createTitleContent:function(){var b=a("<div></div>");b.addClass(this.getNamespace("title"));b.append(this.getTitle()!==null?this.createDynamicContent(this.getTitle()):this.getDefaultText());return b},createCloseButton:function(){var c=a("<div></div>");c.addClass(this.getNamespace("close-button"));var b=a('<button class="close">Ã—</button>');c.append(b);c.on("click",{dialog:this},function(d){d.data.dialog.close()});return c},createBodyContent:function(){var b=a("<div></div>");b.addClass(this.getNamespace("body"));b.append(this.createMessageContent());return b},createMessageContent:function(){var b=a("<div></div>");b.addClass(this.getNamespace("message"));b.append(this.createDynamicContent(this.getMessage()));return b},createFooterContent:function(){var b=a("<div></div>");b.addClass(this.getNamespace("footer"));b.append(this.createFooterButtons());return b},createFooterButtons:function(){var b=this;var c=a("<div></div>");c.addClass(this.getNamespace("footer-buttons"));this.indexedButtons={};a.each(this.options.buttons,function(d,e){var f=b.createButton(e);if(typeof e.id!=="undefined"){b.indexedButtons[e.id]=f}c.append(f)});return c},createButton:function(b){var c=a('<button class="btn"></button>');c.addClass(this.getButtonSize());if(typeof b.icon!==undefined&&a.trim(b.icon)!==""){c.append(this.createButtonIcon(b.icon))}if(typeof b.label!==undefined){c.append(b.label)}if(typeof b.cssClass!==undefined&&a.trim(b.cssClass)!==""){c.addClass(b.cssClass)}else{c.addClass("btn-default")}c.on("click",{dialog:this,button:b},function(f){var e=f.data.dialog;var d=f.data.button;if(typeof d.action==="function"){d.action.call(this,e)}if(d.autospin){var g=a(this);g.find("."+e.getNamespace("button-icon")).remove();g.prepend(e.createButtonIcon(e.getSpinicon()).addClass("icon-spin"))}});return c},createButtonIcon:function(c){var b=a("<span></span>");b.addClass(this.getNamespace("button-icon")).addClass(c);return b},enableButtons:function(c){var b=this.getModalFooter().find(".btn");b.prop("disabled",!c).toggleClass("disabled",!c);return this},updateClosable:function(){if(this.isRealized()){var b=this.getModal();b.off("click").on("click",{dialog:this},function(c){c.target===this&&c.data.dialog.isClosable()&&c.data.dialog.close()});this.getModalHeader().find("."+this.getNamespace("close-button")).toggle(this.isClosable());b.off("keyup").on("keyup",{dialog:this},function(c){c.which===27&&c.data.dialog.isClosable()&&c.data.dialog.close()})}return this},onShow:function(b){this.options.onshow=b;return this},onHide:function(b){this.options.onhide=b;return this},isRealized:function(){return this.realized},setRealized:function(b){this.realized=b;return this},isOpened:function(){return this.opened},setOpened:function(b){this.opened=b;return this},handleModalEvents:function(){this.getModal().on("show.bs.modal",{dialog:this},function(c){var b=c.data.dialog;typeof b.options.onshow==="function"&&b.options.onshow(b);b.showPageScrollBar(true)});this.getModal().on("hide.bs.modal",{dialog:this},function(c){var b=c.data.dialog;typeof b.options.onhide==="function"&&b.options.onhide(b)});this.getModal().on("hidden.bs.modal",{dialog:this},function(c){var b=c.data.dialog;b.isAutodestroy()&&a(this).remove();b.showPageScrollBar(false)});return this},showPageScrollBar:function(b){a(document.body).toggleClass("modal-open",b)},realize:function(){this.initModalStuff();this.getModal().addClass(BootstrapDialog.NAMESPACE).addClass(this.getType()).addClass(this.getSize());this.getModalHeader().append(this.createHeaderContent());this.getModalBody().append(this.createBodyContent());this.getModalFooter().append(this.createFooterContent());this.getModal().modal({backdrop:"static",keyboard:false,show:false});this.handleModalEvents();this.setRealized(true);return this},open:function(){!this.isRealized()&&this.realize();this.updateClosable();this.getModal().modal("show");this.setOpened(true);return this},close:function(){this.getModal().modal("hide");if(this.isAutodestroy()){delete BootstrapDialog.dialogs[this.getId()]}this.setOpened(false);return this}};BootstrapDialog.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=Math.random()*16|0,b=e==="x"?d:(d&3|8);return b.toString(16)})};BootstrapDialog.show=function(b){new BootstrapDialog(b).open()};BootstrapDialog.alert=function(b,c){new BootstrapDialog({message:b,data:{callback:c},closable:false,buttons:[{label:"OK",action:function(d){typeof d.getData("callback")==="function"&&d.getData("callback")(true);d.close()}}]}).open()};BootstrapDialog.confirm=function(b,c){new BootstrapDialog({title:"Confirmation",message:b,closable:false,data:{callback:c},buttons:[{label:"Cancel",action:function(d){typeof d.getData("callback")==="function"&&d.getData("callback")(false);d.close()}},{label:"OK",cssClass:"btn-primary",action:function(d){typeof d.getData("callback")==="function"&&d.getData("callback")(true);d.close()}}]}).open()}}(window.jQuery);